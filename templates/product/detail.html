{{/* Full page — for direct access / non-HTMX */}}
{{define "product-detail"}}
{{template "app-shell" .}}
{{end}}

{{/* Content-only partial — for HTMX navigation */}}
{{define "product-detail-content"}}
<div class="page-content detail-layout" data-page-css="/assets/css/centymo/product-detail.css?v={{.CacheVersion}}">
    {{/* --- HTMX Tab Buttons --- */}}
    <div class="detail-tabs">
        {{template "tabs" (dict "Items" .TabItems "ActiveTab" .ActiveTab "Variant" "default" "ID" "product-detail-tabs")}}
    </div>

    {{/* --- Tab Content Area --- */}}
    <div id="tabContent" class="detail-body">
        {{if eq .ActiveTab "info"}}
            {{template "product-tab-info" .}}
        {{else if eq .ActiveTab "variants"}}
            {{template "product-tab-variants" .}}
        {{else if eq .ActiveTab "attributes"}}
            {{template "product-tab-attributes" .}}
        {{else if eq .ActiveTab "pricing"}}
            {{template "product-tab-pricing" .}}
        {{end}}
    </div>
</div>
{{template "sheet-form" .}}
<script src="/assets/js/components/sheet.js?v={{.CacheVersion}}"></script>
{{end}}

{{/* =============================================
     TAB PARTIAL: Info
     ============================================= */}}
{{define "product-tab-info"}}
<div class="tab-scroll">
    <h4 class="detail-section-title">{{.Labels.Tabs.Info}}</h4>
    <div class="detail-info-grid">
        <div class="detail-info-item">
            <span class="detail-info-label">{{.Labels.Form.Name}}</span>
            <span class="detail-info-value">{{.ProductName}}</span>
        </div>
        <div class="detail-info-item">
            <span class="detail-info-label">{{.Labels.Form.Description}}</span>
            <span class="detail-info-value">{{if .ProductDesc}}{{.ProductDesc}}{{else}}—{{end}}</span>
        </div>
        <div class="detail-info-item">
            <span class="detail-info-label">{{.Labels.Detail.Price}}</span>
            <span class="detail-info-value">{{.ProductPrice}}</span>
        </div>
        <div class="detail-info-item">
            <span class="detail-info-label">{{.Labels.Detail.Currency}}</span>
            <span class="detail-info-value">{{.ProductCurrency}}</span>
        </div>
        <div class="detail-info-item">
            <span class="detail-info-label">{{.Labels.Detail.Status}}</span>
            <span>
                <span class="badge badge--{{.StatusVariant}}">
                    {{.ProductStatus}}
                </span>
            </span>
        </div>
        {{if .Collections}}
        <div class="detail-info-item">
            <span class="detail-info-label">{{.Labels.Detail.Collections}}</span>
            <span class="detail-info-value">
                {{range .Collections}}
                <span class="badge badge--info">{{.}}</span>
                {{end}}
            </span>
        </div>
        {{end}}
    </div>

    <div class="detail-actions" style="margin-top: var(--spacing-lg);">
        <a class="btn btn--ghost btn--sm"
           hx-get="/action/products/edit/{{.ID}}"
           hx-target="#sheetContent"
           hx-swap="innerHTML"
           data-sheet-title="{{.Labels.Actions.Edit}}">
            {{.Labels.Actions.Edit}}
        </a>
    </div>
</div>
{{end}}

{{/* =============================================
     TAB PARTIAL: Variants
     ============================================= */}}
{{define "product-tab-variants"}}
<div class="tab-scroll tab-scroll--table">
    {{if .VariantsTable}}
        {{template "table-card" .VariantsTable}}
    {{else}}
        <div class="coming-soon-panel">
            <div class="coming-soon-title">{{.Labels.Variant.Empty}}</div>
            <p class="coming-soon-text">No variants have been added to this product yet.</p>
        </div>
    {{end}}
</div>
{{end}}

{{/* =============================================
     TAB PARTIAL: Attributes
     ============================================= */}}
{{define "product-tab-attributes"}}
<div class="tab-scroll tab-scroll--table">
    {{if .AttributesTable}}
        {{template "table-card" .AttributesTable}}
    {{else}}
        <div class="coming-soon-panel">
            <div class="coming-soon-title">{{.Labels.Attribute.Empty}}</div>
            <p class="coming-soon-text">No attributes have been assigned to this product yet.</p>
        </div>
    {{end}}
</div>
{{end}}

{{/* =============================================
     TAB PARTIAL: Pricing
     ============================================= */}}
{{define "product-tab-pricing"}}
<div class="tab-scroll tab-scroll--table">
    {{if .PricingTable}}
        {{template "table-card" .PricingTable}}
    {{else}}
        <div class="coming-soon-panel">
            <div class="coming-soon-title">No Price Lists</div>
            <p class="coming-soon-text">This product has not been added to any price lists yet. Manage pricing from the Price Lists section.</p>
        </div>
    {{end}}
</div>
{{end}}
